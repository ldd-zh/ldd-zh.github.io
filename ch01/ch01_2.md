# 内核的划分

在Unix系统中，多个并发进程处理不同的任务。每个进程请求系统资源，无论是计算能力、内存、网络连接还是其他资源。内核是负责处理所有这些请求的大块可执行代码。尽管不同内核任务之间的区别并不总是清晰，但内核的作用可以划分为以下几个部分（如图1-1所示）：

- **进程管理**：内核负责创建和销毁进程，并处理它们与外部世界的连接（输入和输出）。不同进程之间的通信（通过信号、管道或进程间通信原语）是系统整体功能的基础，也由内核处理。此外，调度程序控制进程如何共享CPU，是进程管理的一部分。更一般地说，内核的进程管理活动在单个CPU或少数CPU上实现了多个进程的抽象。

- **内存管理**：计算机的内存是一个主要资源，处理它的策略对系统性能至关重要。内核在有限的可用资源之上为所有进程构建虚拟地址空间。内核的不同部分通过一组函数调用与内存管理子系统交互，从简单的malloc/free对到更复杂的功能。

- **文件系统**：Unix严重依赖于文件系统的概念；几乎所有的东西在Unix中都可以被视为文件。内核在非结构化硬件之上构建结构化文件系统，生成的文件抽象在整个系统中被广泛使用。此外，Linux支持多种文件系统类型，即在物理介质上组织数据的不同方式。例如，磁盘可以格式化为Linux标准的ext3文件系统、常用的FAT文件系统或其他几种文件系统。

- **设备控制**：几乎每个系统操作最终都会映射到物理设备。除了处理器、内存和极少数其他实体外，所有设备控制操作都由特定于设备的代码执行。该代码称为设备驱动程序。内核必须嵌入系统中每个外围设备的设备驱动程序，从硬盘到键盘和磁带驱动器。内核功能的这一方面是我们在本书中的主要兴趣所在。

- **网络**：网络必须由操作系统管理，因为大多数网络操作不特定于某个进程：传入的数据包是异步事件。数据包必须被收集、识别和分发，然后由进程处理。系统负责跨程序和网络接口传递数据包，并且必须根据程序的网络活动控制其执行。此外，所有路由和地址解析问题都在内核内实现。

## 可加载模块

Linux的一个优点是能够在运行时扩展内核提供的功能集。这意味着你可以在系统运行时添加（或删除）内核功能。

每个可以在运行时添加到内核的代码片段称为模块。Linux内核支持多种不同类型的模块，包括但不限于设备驱动程序。每个模块由目标代码（未链接到完整的可执行文件中）组成，可以通过insmod程序动态链接到运行中的内核，并可以通过rmmod程序取消链接。

图1-1标识了负责特定任务的不同模块类——根据模块提供的功能，模块被归类为特定类。图1-1中模块的位置涵盖了最重要的类，但远未完成，因为Linux中越来越多的功能正在模块化。
